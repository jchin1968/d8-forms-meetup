<!DOCTYPE html>
<html>
  <head>
    <title>Singapore Drupal Meetup</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="remark.css" type="text/css"/>
  </head>
  <body>
    <textarea id="source">

class: center, middle
# Creating and Modifying Forms<br>in Drupal 8
### Joseph Chin<br>Singapore Drupal Meetup<br>October 24, 2016 



---
# Hello
* Joseph Chin
* Drupal Solution Architect since 2007
* Committee Member of the Singapore Drupal Meetup
* jchin1968 on .media-icon[![image](images/google.png) ![image](images/twitter.png) ![image](images/linkedin.png) ![image](images/facebook.png) ![image](images/github.png)]



---
# Agenda
* Create a custom form 
* Modify an existing form

???
* Custom forms are created using the new object-oriented procedure
* Modifying forms, however, reverts back to the older hook() function procedure



---
# Setup a New Module

myform.info.yml
```yaml
name: MyForm 
description: 'Drupal 8 form examples'
type: module
core: 8.x
```

???
* info.yml file required regardless 



---
# Create Routing file
myform.routing.yml

```yaml
beedit.add:
  path: '/admin/config/development/beedit/edit'
  defaults:
    _title: 'BeEdit'
    _form: '\Drupal\beedit\Form\BeEditEditForm'
  requirements:
    _permission: 'access content'
```




---
# Write Assertion Logic

FeatureContext.php
```php
  /**
   * @Then the datetime in region :region is not older than :hours hours
   */
  public function theDatetimeInRegionIsNotOlderThanHours($region, $hours) {
*    // Get the region where a date string is supposed to be
*    $region_object = $this->getSession()->getPage()->find('region', $region);
*    if (!$region_object) {
*      throw new \Exception(sprintf('No region "%s" found on the page %s.',
*        $region, $this->getSession()->getCurrentUrl()));
*    }
*
*    // Get region date string and convert to unix timestamp
*    $date_string = $region_object->getText();
*    $timestamp = strtotime($date_string);
*
*    // Compare region and current timestamps  
*    if (time() - $timestamp > $hours * 3600) {
*     throw new \Exception(sprintf('Datetime in "%s" is older then %s hours',
*        $region, $hours));
*    }
  }
```
???
* php-doc annotation is used to define the step definition pattern
* arg1 and arg2 can be renamed to something more meaningful
* getSession() method is inherited from a Mink class. Mink is like a browser emulator and it contain methods to analyze the content of an html page
* strtotime() is a php function to convert human-readable dates and times into    

---
# Update Behat Configuration

behat.yml
```yaml
default:
  suites:
    ...
    ...
  extensions:
    Behat\MinkExtension:
      ...
      ...
    Drupal\DrupalExtension:
      ...
      ...
    region_map:
*     news_publish_date: ".view-news .views-row-1 .views-field-created"
```

???
* Don't always need to update. In our case, we added one line to region_map which makes it easier to work with "news_publish_date" instead of messy css selectors


---
# Demo


---
# Closing Remarks
* Behat for Drupal 8 is not quite ready for prime time
* Running Behat tests can take a while. Checkout my project, [Beekeeper on Github](https://github.com/jchin1968/beekeeper), for running Behat in parallel using AWS
* You can find these slides here: https://github.com/jchin1968/dcmanila2016-presentation


---
# References
* http://behat-drupal-extension.readthedocs.io/en/3.1
* https://www.drupal.org/project/drupalextension
* https://www.previousnext.com.au/blog/custom-step-definitions-drupal-drupalextension-and-behat

---
# Q&amp;A

.center.middle[![image](images/questionmarktie.jpg)]



    </textarea>
    <script src="remark.js" type="text/javascript">
    </script>
    <script type="text/javascript">
      var slideshow = remark.create({
        highlightLines: true
      });
    </script>
  </body>
</html>
